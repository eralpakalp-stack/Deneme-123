<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Title is generic to hide the surprise -->
  <title>Quick Knowledge Test</title> 
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Custom styles for aesthetic appeal */
    * { box-sizing: border-box; }
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f9f7f3; 
    }
    .question-card {
      background: #ffffff;
      border-radius: 1rem;
      padding: 1.5rem;
      box-shadow: 0 10px 30px rgba(0,0,0,0.15);
      transition: all 0.6s ease;
      max-width: 400px;
      margin: 2rem auto;
      border: 1px solid #f0f0f0;
    }
    .option-button {
      background: #a8dadc; /* Light Cyan */
      color: #1d3557; /* Dark Blue */
      transition: all 0.2s ease;
      font-weight: 600;
      border: 3px solid transparent;
    }
    .option-button:hover:not(:disabled) {
      background: #457b9d; /* Medium Blue */
      color: #fff;
    }
    .option-button:disabled {
      cursor: default;
      opacity: 0.8;
      box-shadow: none;
    }
    /* Feedback colors */
    .correct-feedback { background-color: #4CAF50; color: white; border-color: #4CAF50; } /* Green */
    .wrong-feedback { background-color: #F44336; color: white; border-color: #F44336; } /* Red */
    
    .next-button {
        background: #e63946; /* Surprise Red */
        transition: transform 0.1s ease-in-out;
    }
    .next-button:hover {
        background: #c32f38;
        transform: scale(1.02);
    }
    /* Popup Animation */
    .popup-content {
      animation: popupShow 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    @keyframes popupShow {
      0% { transform: scale(0.5); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }
  </style>
</head>
<body class="min-h-screen flex flex-col justify-center items-center p-4">

  <!-- Main Title and Score Area -->
  <div class="text-center mb-8">
    <h1 id="mainTitle" class="text-3xl md:text-4xl font-extrabold text-[#1d3557] tracking-tight">
      A Fun Knowledge Challenge
    </h1>
    <p class="text-lg text-gray-500 mt-2" id="scoreDisplay">Level 1: 0 Points</p>
  </div>

  <!-- Quiz Area (Questions will be dynamically loaded here) -->
  <div id="quizContainer" class="w-full max-w-lg">
    <!-- Questions dynamically added here -->
  </div>
  
  <!-- Level Transition and Success Message -->
  <div id="levelMessageContainer" class="hidden text-center mt-8 p-6 question-card">
    <h2 id="levelMessageTitle" class="text-2xl font-bold text-[#457b9d] mb-4"></h2>
    <p id="levelMessageText" class="text-gray-600 mb-6 max-w-md mx-auto"></p>
    <button id="nextLevelButton" onclick="nextLevel()" 
            class="next-button text-white font-bold py-3 px-8 rounded-full shadow-lg text-xl transition duration-300">
      Proceed to Next Level!
    </button>
  </div>

  <!-- Proposal Popup / Final Result -->
  <div class="fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center p-4 z-50 hidden" id="popup">
    <div class="popup-content bg-white p-8 rounded-2xl shadow-2xl text-center max-w-sm w-full">
      <h2 id="popupTitle" class="text-4xl font-extrabold text-[#e63946] mb-4"></h2>
      <p id="popupText" class="text-gray-700 text-lg mb-6"></p>
      
      <!-- The image element is now ready to receive your public URL -->
      <img id="proposalImage" 
           src="https://placehold.co/400x300/e63946/ffffff?text=Image+Loading..." 
           alt="The Big Moment" 
           class="rounded-xl mx-auto mb-4 shadow-lg w-full max-w-xs"
           onerror="this.onerror=null; this.src='https://placehold.co/400x300/555/fff?text=Image+Failed+to+Load%3A+Check+Public+Link';"
      />
      
      <button onclick="window.location.reload()" 
              class="bg-gray-400 text-white font-bold py-2 px-6 rounded-lg hover:bg-gray-500 transition duration-200">
        Start Over
      </button>
    </div>
  </div>

  <!-- Sound Effect (Error) -->
  <audio id="wrongSound" src="https://www.soundjay.com/button/sounds/button-10.mp3"></audio>

  <script>
    // --- QUIZ DATA: FINALIZED QUESTIONS ---
    const quizData = {
      level1: {
        scoreNeeded: 2, // Needs at least 2 correct answers out of 3
        questions: [
          // LEVEL 1: GENERAL KNOWLEDGE (EASY)
          { q: "Question 1: What is the largest planet in our solar system?", options: ["Mars", "Jupiter", "Venus"], correctIndex: 1 },
          { q: "Question 2: How many days are in the year 2025?", options: ["365", "367", "366"], correctIndex: 0 }, 
          { q: "Question 3: Which colour is made by mixing blue and yellow?", options: ["Red", "Green", "Purple"], correctIndex: 1 }
        ]
      },
      level2: {
        scoreNeeded: 2, // Needs at least 2 correct answers out of 3
        questions: [
          // LEVEL 2: GENERAL KNOWLEDGE (MODERATE - Your edited questions)
          { q: "Question 4: What is the common name for the element H‚ÇÇO?", options: ["Oxygen", "Water", "Carbon Dioxide"], correctIndex: 1 }, 
          { q: "Question 5: Who is the expected top scorer for Galatasaray in the 2024-2025 season?", options: ["Victor Osimhen", "Lionel Messi", "Pelin √áoban"], correctIndex: 0 }, 
          { q: "Question 6: Which country is the origin of the Olympic Games?", options: ["Italy", "Greece", "China"], correctIndex: 1 }
        ]
      },
      level3: {
        scoreNeeded: 1, // Final question requires 1 correct answer (1/1)
        questions: [
          // LEVEL 3: THE PROPOSAL QUESTION (Your final choice)
          { q: "Question 7: What‚Äôs the one dream I never want to wake up from?", options: ["A beach holiday", "A perfect job", "A life with you"], correctIndex: 2 }
        ]
      }
    };

    // --- STATE VARIABLES ---
    let currentLevel = 1;
    let currentQuestionIndex = 0;
    let score = 0;
    let isLocked = false; 

    // --- UTILITY FUNCTIONS ---
    function getLevelData() {
      return quizData['level' + currentLevel];
    }

    // --- RENDERING FUNCTIONS ---
    function renderQuestion() {
      const data = getLevelData();
      const q = data.questions[currentQuestionIndex];
      const container = document.getElementById('quizContainer');

      // Clear previous content and hide level message
      container.innerHTML = '';
      document.getElementById('levelMessageContainer').classList.add('hidden');
      isLocked = false; 

      const card = document.createElement('div');
      card.className = 'question-card flex flex-col items-center';
      card.innerHTML = `
        <h2 class="text-xl md:text-2xl font-semibold text-center text-[#1d3557] mb-6">
          ${q.q}
        </h2>
        <div class="options w-full space-y-3">
          ${q.options.map((option, index) => `
            <button class="option-button w-full py-3 px-4 rounded-xl shadow-md text-base" data-index="${index}" onclick="handleAnswer(this, ${q.correctIndex})">
              ${option}
            </button>
          `).join('')}
        </div>
        <div id="feedback" class="feedback text-center mt-4 text-sm font-medium min-h-6"></div>
      `;
      container.appendChild(card);
      updateScoreDisplay();
    }

    function updateScoreDisplay() {
      const data = getLevelData();
      document.getElementById('scoreDisplay').textContent = 
        `Level ${currentLevel} | Score: ${score} / ${data.questions.length} | Goal: ${data.scoreNeeded} Correct`;
    }

    function showLevelMessage(passed) {
      const container = document.getElementById('levelMessageContainer');
      const title = document.getElementById('levelMessageTitle');
      const text = document.getElementById('levelMessageText');
      const nextButton = document.getElementById('nextLevelButton');
      
      container.classList.remove('hidden');
      document.getElementById('quizContainer').innerHTML = '';

      if (passed) {
        title.textContent = "ü•≥ Congratulations! Level Complete!";
        text.textContent = "You passed with flying colours! Access granted to the next challenge!";
        nextButton.classList.remove('hidden');
      } else {
        title.textContent = "üòî Access Denied...";
        text.textContent = `You needed at least ${getLevelData().scoreNeeded} correct answers to proceed. You must restart the quiz to see the surprise!`;
        nextButton.classList.add('hidden');
        
        // Add Restart Button
        let restartButton = document.getElementById('restartButton');
        if (!restartButton) {
            restartButton = document.createElement('button');
            restartButton.id = 'restartButton';
            restartButton.className = "next-button text-white font-bold py-3 px-8 rounded-full shadow-lg text-xl transition duration-300 mt-4";
            restartButton.onclick = () => window.location.reload();
            container.appendChild(restartButton);
        }
        restartButton.textContent = "Restart Challenge";
      }
    }

    function showPopup(success) {
      const popup = document.getElementById('popup');
      const popupTitle = document.getElementById('popupTitle');
      const popupText = document.getElementById('popupText');
      const proposalImage = document.getElementById('proposalImage');

      if (success) {
        // THE GRAND PROPOSAL!
        popupTitle.textContent = "üíç THE BIGGEST QUESTION! ‚ù§Ô∏è";
        popupText.textContent = "You successfully completed the challenge of a lifetime! Are you ready to start our biggest adventure yet? Will you marry me?";
        
        // <<< IMPORTANT: REPLACE THIS URL WITH YOUR DIRECT PUBLIC IMAGE LINK (.jpg, .png, etc.) >>>
        // Example: "https://i.imgur.com/myproposalphoto.jpg"
        proposalImage.src = "YOUR_DIRECT_PUBLIC_IMAGE_URL_HERE"; 
        
      } else {
        // Fail state for Level 3
        popupTitle.textContent = "Challenge Completed";
        popupText.textContent = "You finished the test, but didn't unlock the final surprise. Please try again from the beginning!";
      }
      popup.classList.remove('hidden');
    }

    // --- EVENT HANDLERS ---
    function handleAnswer(button, correctIndex) {
      if (isLocked) return; 
      isLocked = true; 
      
      const buttons = button.parentNode.querySelectorAll('button');
      const feedback = document.getElementById('feedback');
      const selectedIndex = parseInt(button.getAttribute('data-index'));

      // Disable all buttons
      buttons.forEach(btn => btn.disabled = true);
      
      // Visually mark the selected button
      button.classList.add('scale-105', 'shadow-xl');

      if (selectedIndex === correctIndex) {
        score++;
        button.classList.remove('option-button', 'bg-[#a8dadc]');
        button.classList.add('correct-feedback');
        feedback.textContent = "Fantastic! You earned a point! üëç";
      } else {
        document.getElementById('wrongSound').play();
        button.classList.remove('option-button', 'bg-[#a8dadc]');
        button.classList.add('wrong-feedback');
        feedback.textContent = "Oops, wrong answer. The correct answer was: " + buttons[correctIndex].textContent;
        
        // Highlight the correct answer
        buttons[correctIndex].classList.add('correct-feedback');
      }

      updateScoreDisplay();

      // Proceed to next question or check level completion
      setTimeout(() => {
        currentQuestionIndex++;
        if (currentQuestionIndex < getLevelData().questions.length) {
          renderQuestion();
        } else {
          checkLevelCompletion();
        }
      }, 1500);
    }

    function checkLevelCompletion() {
      const data = getLevelData();
      const passed = score >= data.scoreNeeded;

      if (currentLevel === 3) {
        showPopup(passed);
      } else {
        showLevelMessage(passed);
      }
    }

    function nextLevel() {
      currentLevel++;
      currentQuestionIndex = 0;
      score = 0; // Reset score for the new level
      document.getElementById('levelMessageContainer').classList.add('hidden');
      renderQuestion();
    }

    // --- INITIALIZATION ---
    window.onload = renderQuestion;
  </script>
</body>
</html>
